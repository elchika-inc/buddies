# PawMatch API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

## ğŸ“¡ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§

### ãƒ™ãƒ¼ã‚¹URL
- **æœ¬ç•ªç’°å¢ƒ**: `https://pawmatch-api.YOUR_SUBDOMAIN.workers.dev`
- **ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º**: `http://localhost:8788`

## ğŸ¾ ãƒšãƒƒãƒˆé–¢é€£API

### ãƒšãƒƒãƒˆä¸€è¦§å–å¾—
ã™ã¹ã¦ã®ãƒšãƒƒãƒˆæƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚

```http
GET /pets
```

#### ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | å‹ | å¿…é ˆ | èª¬æ˜ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ |
|------------|-----|------|------|------------|
| `limit` | integer | âŒ | å–å¾—ä»¶æ•°ï¼ˆæœ€å¤§100ï¼‰ | 20 |
| `offset` | integer | âŒ | ã‚¹ã‚­ãƒƒãƒ—ä»¶æ•° | 0 |
| `prefecture` | string | âŒ | éƒ½é“åºœçœŒãƒ•ã‚£ãƒ«ã‚¿ | - |

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹
```json
{
  "pets": [
    {
      "id": "523509",
      "type": "cat",
      "name": "ã‚·ãƒ£ã‚¤ãªå¥³ã®å­ç”Ÿå¾Œ8ãƒ¶æœˆæ±äº¬éƒ½",
      "breed": "é›‘ç¨®",
      "age": 2,
      "gender": "å¥³ã®å­",
      "prefecture": "æ±äº¬éƒ½",
      "city": "æ–°å®¿åŒº",
      "location": "æ±äº¬éƒ½æ–°å®¿åŒº",
      "description": "ç´ æ•µãªçŒ«ã¡ã‚ƒã‚“ã§ã™...",
      "personality": ["äººæ‡ã£ã“ã„", "ç”˜ãˆã‚“åŠ"],
      "medical_info": "ãƒ¯ã‚¯ãƒãƒ³æ¥ç¨®æ¸ˆã¿ã€å¥åº·ãƒã‚§ãƒƒã‚¯æ¸ˆã¿",
      "care_requirements": ["å®Œå…¨å®¤å†…é£¼ã„", "å®šæœŸå¥è¨º"],
      "image_url": "/images/cat-523509.jpg",
      "shelter_name": "æ±äº¬éƒ½å‹•ç‰©ä¿è­·ã‚»ãƒ³ã‚¿ãƒ¼",
      "created_at": "2025-08-18T09:00:53.271Z"
    }
  ],
  "pagination": {
    "limit": 20,
    "offset": 0,
    "total": 1
  }
}
```

### çŒ«ä¸€è¦§å–å¾—
çŒ«ã®ãƒšãƒƒãƒˆæƒ…å ±ã®ã¿ã‚’å–å¾—ã—ã¾ã™ã€‚

```http
GET /pets/cat
```

#### ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
ãƒšãƒƒãƒˆä¸€è¦§å–å¾—ã¨åŒã˜ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒä½¿ç”¨å¯èƒ½ã§ã™ã€‚

### çŠ¬ä¸€è¦§å–å¾—  
çŠ¬ã®ãƒšãƒƒãƒˆæƒ…å ±ã®ã¿ã‚’å–å¾—ã—ã¾ã™ã€‚

```http
GET /pets/dog
```

#### ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
ãƒšãƒƒãƒˆä¸€è¦§å–å¾—ã¨åŒã˜ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒä½¿ç”¨å¯èƒ½ã§ã™ã€‚

### ç‰¹å®šãƒšãƒƒãƒˆè©³ç´°å–å¾—
æŒ‡å®šã•ã‚ŒãŸãƒšãƒƒãƒˆã®è©³ç´°æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚

```http
GET /pets/{type}/{id}
```

#### ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | å‹ | å¿…é ˆ | èª¬æ˜ |
|------------|-----|------|------|
| `type` | string | âœ… | ãƒšãƒƒãƒˆç¨®åˆ¥ï¼ˆ`cat` ã¾ãŸã¯ `dog`ï¼‰ |
| `id` | string | âœ… | ãƒšãƒƒãƒˆID |

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹
```json
{
  "pet": {
    "id": "523509",
    "type": "cat",
    "name": "ã‚·ãƒ£ã‚¤ãªå¥³ã®å­ç”Ÿå¾Œ8ãƒ¶æœˆæ±äº¬éƒ½",
    "breed": "é›‘ç¨®",
    "age": 2,
    "gender": "å¥³ã®å­",
    "prefecture": "æ±äº¬éƒ½",
    "city": "æ–°å®¿åŒº",
    "location": "æ±äº¬éƒ½æ–°å®¿åŒº",
    "description": "ç´ æ•µãªçŒ«ã¡ã‚ƒã‚“ã§ã™...",
    "personality": ["äººæ‡ã£ã“ã„", "ç”˜ãˆã‚“åŠ"],
    "medical_info": "ãƒ¯ã‚¯ãƒãƒ³æ¥ç¨®æ¸ˆã¿ã€å¥åº·ãƒã‚§ãƒƒã‚¯æ¸ˆã¿",
    "care_requirements": ["å®Œå…¨å®¤å†…é£¼ã„", "å®šæœŸå¥è¨º"],
    "image_url": "/images/cat-523509.jpg",
    "shelter_name": "æ±äº¬éƒ½å‹•ç‰©ä¿è­·ã‚»ãƒ³ã‚¿ãƒ¼",
    "shelter_contact": "pethome@example.com",
    "source_url": "https://www.pet-home.jp/cats/tokyo/pn523509/",
    "created_at": "2025-08-18T09:00:53.271Z",
    "metadata": {
      "socialLevel": "æ™®é€š",
      "indoorOutdoor": "å®Œå…¨å®¤å†…",
      "groomingRequirements": "ä¸­",
      "vocalizationLevel": "æ™®é€š",
      "activityTime": "ã©ã¡ã‚‰ã§ã‚‚",
      "playfulness": "ä¸­"
    }
  }
}
```

## ğŸ–¼ï¸ ç”»åƒé…ä¿¡API

### ãƒšãƒƒãƒˆç”»åƒå–å¾—
ãƒšãƒƒãƒˆã®ç”»åƒã‚’å–å¾—ã—ã¾ã™ã€‚

```http
GET /images/{type}/{filename}
```

#### ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | å‹ | å¿…é ˆ | èª¬æ˜ |
|------------|-----|------|------|
| `type` | string | âœ… | ãƒšãƒƒãƒˆç¨®åˆ¥ï¼ˆ`cats` ã¾ãŸã¯ `dogs`ï¼‰ |
| `filename` | string | âœ… | ãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆä¾‹: `cat-523509.jpg`ï¼‰ |

#### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- **ãƒªãƒ•ã‚¡ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯**: è¨±å¯ã•ã‚ŒãŸãƒ‰ãƒ¡ã‚¤ãƒ³ã‹ã‚‰ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- **CORSåˆ¶é™**: è¨­å®šã•ã‚ŒãŸãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã¿
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: 24æ™‚é–“ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€1å¹´CDNã‚­ãƒ£ãƒƒã‚·ãƒ¥

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹
- **Content-Type**: `image/jpeg`
- **Cache-Control**: `public, max-age=31536000`
- **Body**: ãƒã‚¤ãƒŠãƒªç”»åƒãƒ‡ãƒ¼ã‚¿

## ğŸ“Š çµ±è¨ˆãƒ»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿API

### ã‚·ã‚¹ãƒ†ãƒ çµ±è¨ˆå–å¾—
ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®çµ±è¨ˆæƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚

```http
GET /stats
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹
```json
{
  "total": 150,
  "dogs": 75,
  "cats": 75,
  "last_updated": "2025-08-18T12:00:00.000Z"
}
```

### éƒ½é“åºœçœŒä¸€è¦§å–å¾—
ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ãƒšãƒƒãƒˆã®éƒ½é“åºœçœŒä¸€è¦§ã‚’å–å¾—ã—ã¾ã™ã€‚

```http
GET /prefectures
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹
```json
{
  "prefectures": [
    "åŒ—æµ·é“",
    "é’æ£®çœŒ",
    "å²©æ‰‹çœŒ",
    "å®®åŸçœŒ",
    "æ±äº¬éƒ½",
    "å¤§é˜ªåºœ",
    "ç¦å²¡çœŒ"
  ]
}
```

### ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
APIã®å‹•ä½œçŠ¶æ³ã‚’ç¢ºèªã—ã¾ã™ã€‚

```http
GET /
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹
```json
{
  "service": "PawMatch API",
  "status": "healthy",
  "timestamp": "2025-08-18T12:00:00.000Z"
}
```

## ğŸ•·ï¸ ã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼API

### ãƒ™ãƒ¼ã‚¹URL
- **æœ¬ç•ªç’°å¢ƒ**: `https://pawmatch-crawler.YOUR_SUBDOMAIN.workers.dev`
- **ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º**: `http://localhost:8787`

### æ‰‹å‹•ã‚¯ãƒ­ãƒ¼ãƒ«å®Ÿè¡Œ
æŒ‡å®šã•ã‚ŒãŸç¨®åˆ¥ã®ãƒšãƒƒãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æ‰‹å‹•ã§ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¾ã™ã€‚

```http
POST /crawl/{type}
```

#### ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | å‹ | å¿…é ˆ | èª¬æ˜ |
|------------|-----|------|------|
| `type` | string | âŒ | ãƒšãƒƒãƒˆç¨®åˆ¥ï¼ˆ`cat` ã¾ãŸã¯ `dog`ï¼‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: `cat` |

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹
```json
{
  "message": "cat crawling completed",
  "result": {
    "success": true,
    "totalPets": 15,
    "newPets": 5,
    "updatedPets": 10,
    "errors": []
  },
  "timestamp": "2025-08-18T12:00:00.000Z"
}
```

### ã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
ã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼ã®å‹•ä½œçŠ¶æ³ã‚’ç¢ºèªã—ã¾ã™ã€‚

```http
GET /
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹
```json
{
  "service": "PawMatch Crawler",
  "status": "healthy",
  "timestamp": "2025-08-18T12:00:00.000Z"
}
```

## ğŸš« ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹

### ã‚¨ãƒ©ãƒ¼å½¢å¼
ã™ã¹ã¦ã®ã‚¨ãƒ©ãƒ¼ã¯ä»¥ä¸‹ã®å½¢å¼ã§è¿”ã•ã‚Œã¾ã™ï¼š

```json
{
  "error": "ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"
}
```

### HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰
| ã‚³ãƒ¼ãƒ‰ | èª¬æ˜ | ä¸»ãªç™ºç”Ÿå ´é¢ |
|--------|------|--------------|
| 200 | æˆåŠŸ | æ­£å¸¸ãªãƒ¬ã‚¹ãƒãƒ³ã‚¹ |
| 400 | ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼ | ç„¡åŠ¹ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ç„¡åŠ¹ãªãƒšãƒƒãƒˆç¨®åˆ¥ |
| 403 | ã‚¢ã‚¯ã‚»ã‚¹æ‹’å¦ | CORSé•åã€ãƒªãƒ•ã‚¡ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯å¤±æ•— |
| 404 | è¦‹ã¤ã‹ã‚‰ãªã„ | å­˜åœ¨ã—ãªã„ãƒšãƒƒãƒˆã€å­˜åœ¨ã—ãªã„ç”»åƒ |
| 500 | ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ã€å†…éƒ¨ã‚¨ãƒ©ãƒ¼ |

### ã‚¨ãƒ©ãƒ¼ä¾‹

#### ç„¡åŠ¹ãªãƒšãƒƒãƒˆç¨®åˆ¥
```http
GET /pets/bird
```
```json
{
  "error": "Invalid pet type"
}
```

#### ãƒšãƒƒãƒˆãŒè¦‹ã¤ã‹ã‚‰ãªã„
```http
GET /pets/cat/nonexistent
```
```json
{
  "error": "Pet not found"
}
```

#### ç”»åƒãŒè¦‹ã¤ã‹ã‚‰ãªã„
```http
GET /images/cats/nonexistent.jpg
```
```json
{
  "error": "Image not found"
}
```

## ğŸ“ ä½¿ç”¨ä¾‹

### JavaScript (Fetch API)
```javascript
// ãƒšãƒƒãƒˆä¸€è¦§å–å¾—
const response = await fetch('https://pawmatch-api.example.workers.dev/pets/cat?limit=10');
const data = await response.json();
console.log(data.pets);

// ç‰¹å®šãƒšãƒƒãƒˆå–å¾—
const pet = await fetch('https://pawmatch-api.example.workers.dev/pets/cat/523509');
const petData = await pet.json();
console.log(petData.pet);

// çµ±è¨ˆæƒ…å ±å–å¾—
const stats = await fetch('https://pawmatch-api.example.workers.dev/stats');
const statsData = await stats.json();
console.log(`Total pets: ${statsData.total}`);
```

### cURL
```bash
# ãƒšãƒƒãƒˆä¸€è¦§å–å¾—
curl "https://pawmatch-api.example.workers.dev/pets?limit=5" | jq '.'

# çŒ«ä¸€è¦§å–å¾—
curl "https://pawmatch-api.example.workers.dev/pets/cat" | jq '.'

# æ‰‹å‹•ã‚¯ãƒ­ãƒ¼ãƒ«å®Ÿè¡Œ
curl -X POST "https://pawmatch-crawler.example.workers.dev/crawl/cat" | jq '.'

# ç”»åƒå–å¾—
curl -o cat.jpg "https://pawmatch-api.example.workers.dev/images/cats/cat-523509.jpg"
```

### Python (requests)
```python
import requests

# ãƒ™ãƒ¼ã‚¹URL
api_base = "https://pawmatch-api.example.workers.dev"

# ãƒšãƒƒãƒˆä¸€è¦§å–å¾—
response = requests.get(f"{api_base}/pets/cat", params={"limit": 10})
pets = response.json()["pets"]

# ç‰¹å®šãƒšãƒƒãƒˆå–å¾—
pet_response = requests.get(f"{api_base}/pets/cat/523509")
pet_data = pet_response.json()["pet"]

print(f"Pet name: {pet_data['name']}")
print(f"Breed: {pet_data['breed']}")
```

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ãƒ¬ãƒ¼ãƒˆåˆ¶é™

### CORSè¨­å®š
- è¨±å¯ã•ã‚ŒãŸã‚ªãƒªã‚¸ãƒ³ã‹ã‚‰ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- é–‹ç™ºç’°å¢ƒ: `http://localhost:3004`ã€`http://localhost:8787`ã€`http://localhost:8788`
- æœ¬ç•ªç’°å¢ƒ: è¨­å®šã•ã‚ŒãŸãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã¿

### ãƒ¬ãƒ¼ãƒˆåˆ¶é™
- Cloudflareã®æ¨™æº–DDoSä¿è­·ãŒé©ç”¨
- é€šå¸¸åˆ©ç”¨ã§ã¯åˆ¶é™ã«ã‹ã‹ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“
- ç•°å¸¸ãªãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã¯è‡ªå‹•çš„ã«ãƒ–ãƒ­ãƒƒã‚¯

### ç”»åƒã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- ãƒªãƒ•ã‚¡ãƒ©ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã‚ˆã‚‹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™
- ç›´ãƒªãƒ³ã‚¯ã®é˜²æ­¢
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®ä»˜ä¸

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥
- **API ãƒ¬ã‚¹ãƒãƒ³ã‚¹**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãªã—ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿ï¼‰
- **ç”»åƒé…ä¿¡**: 24æ™‚é–“ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€1å¹´CDNã‚­ãƒ£ãƒƒã‚·ãƒ¥
- **é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„**: ã‚¨ãƒƒã‚¸ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥

### ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“
- **API**: ~50-200msï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¨ãƒƒã‚¸çµŒç”±ï¼‰
- **ç”»åƒé…ä¿¡**: ~10-50msï¼ˆCDNã‚­ãƒ£ãƒƒã‚·ãƒ¥æ™‚ï¼‰
- **ã‚¯ãƒ­ãƒ¼ãƒ«**: æ•°ç§’ã€œæ•°åˆ†ï¼ˆãƒ‡ãƒ¼ã‚¿é‡ã«ã‚ˆã‚‹ï¼‰

## ğŸ”§ é–‹ç™ºè€…å‘ã‘æƒ…å ±

### API ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°
ç¾åœ¨ã¯v1ã®ã¿ã€‚å°†æ¥çš„ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã‚’å°å…¥äºˆå®šã€‚

### å¤‰æ›´ãƒ­ã‚°
- **2025-08**: åˆæœŸãƒªãƒªãƒ¼ã‚¹
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ã€CORSè¨­å®šè¿½åŠ 
- ç”»åƒæœ€é©åŒ–ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥æ”¹å–„

### ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ãƒ–ãƒ©ã‚¦ã‚¶
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+